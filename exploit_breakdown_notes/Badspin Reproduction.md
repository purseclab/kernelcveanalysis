Currently attemtping to reproduce CVE-2022-20421 (https://github.com/0xkol/badspin/tree/main)
TODO: make all steps more complete
# Setup Cuttlefish
Roughly follow https://source.android.com/docs/devices/cuttlefish/get-started

Installing only change was had to modify libtiff5 to libtiff6 in dpkg config.

# Building Badspin
Install android studio cli tools, and use those to install ndk.

Compile badspin with:
`$env.ANDROID_NDK_HOME = "/home/jack/Documents/college/purdue/research/android_sdk/ndk/25.2.9519653/"; make all`

# Running Custom Kernel
`HOME=$PWD ./bin/launch_cvd -kernel_path=./Image -initramfs_path=initramfs.img -cpus 8`
Note badspin requires at least 5 cpus I think, use 8 to be safe

# Badspin Issues Encountered
- First issue: kernel hangs after `triggering UAF` printed
	- This is caused by not enough cpus being available in cuttlefish VM
	- Raise CPU number from 2 to 8
- Second Issue: `epool_ctl` fails with`ENOSPC` when setting up timerfd race extension trick
	- This is caused by epoll user watch limit in `/proc/sys/fs/epoll/max_user_watches` being hit
	- Exploit makes about 50000 epoll entries per try
	- Limit is around 16600
	- Instead set amount used around 15000