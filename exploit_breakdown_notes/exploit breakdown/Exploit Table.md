This is a table overview of some properties of each exploit.

# Table Columns
### Exploit Families
Exploit family is noting which exploits are very similar in structure and likely copied the same format and code.

##### UAF on Qdisc into eBPF shellcode
Basically [[CVE-2023-4206 (lts, cos)]], initial bug might be slightly different.

##### UAF on `nft_chain`
Basically [[CVE-2023-3777 (lts)]], initial bug might be changed

### Code Execution Method
Code execution method is for example, rop, jop with rop, the eBPF jit shellcode technique, etc

### Privilege Escalation Technique
Privilege Escalation Technique is what the final thing the exploit does to gain privileges is.
This is usually either `commit_creds(init_creds())` (set process to root) or overwrite `/proc/sys/kernel/core_pattern` to control crash dump program.

### KASLR Leak Method
KASLR leak method is like, how it leaked a pointer, or did it use the sidechannel.

| Exploit                                  | Exploit Family?                                    | Bug Type              | Bug Details                                                                                                                                                                                       | Exploit Techniques                                                                        | Code Execution Method | Privilege Escalation Technique            | KASLR Leak Method                             | Data Address Leaks                                                     | Required Config                                                       |
| ---------------------------------------- | -------------------------------------------------- | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | --------------------- | ----------------------------------------- | --------------------------------------------- | ---------------------------------------------------------------------- | --------------------------------------------------------------------- |
| CVE-2023-4622 (lts, cos)                 | Unique                                             | Race Condition -> UAF | Race condition in `unix_stream_sendpage` with socket GC causes extra refcount decrament on skb.                                                                                                   | Cross Cache Attack, Timer fd extend race window, msg_msg                                  | ROP                   | Overwrite `/proc/sys/kernel_core_pattern` | [[Entry Bleed (CVE-2022-4543)]]               | leak heap address with corrupted `msg_msg`                             | `CONFIG_UNIX=y`                                                       |
| [[CVE-2024-36972 (lts, cos)]]            | Unique                                             | Race Condition -> UAF | Race condition in unix sockets involving socket GC and out of band messages                                                                                                                       | Cross Cache Attack, Timer fd extend race window                                           | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_AF_UNIX_OOB=y` `CONFIG_BPF_SYSCALL=y`                         |
| CVE-2024-39503 (lts, cos)                | Unique                                             | Race Condition -> UAF |                                                                                                                                                                                                   |                                                                                           | None, Arbitrary Write | Overwrite `/proc/sys/kernel_core_pattern` | Leak kernel point on heap                     |                                                                        |                                                                       |
| CVE-2023-52447 (cos)                     |                                                    | Race Condition -> UAF |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-6932 (cos)                      |                                                    | Race Condition -> UAF |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2024-26925 (lts, cos)                |                                                    | Race Condition -> UAF |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| [[CVE-2024-41009 (lts, cos)]]            | Unique                                             | Buffer Overlap        | Malicious `consumer_offset` in eBPF ringbuffer can cause overlapping objects in ringbuffer allowing header to be overwritten                                                                      |                                                                                           | ROP                   | Overwrite `/proc/sys/kernel_core_pattern` | [[Entry Bleed (CVE-2022-4543)]]               | stack pivot to register with correct address                           | `CONFIG_BPF_SYSCALL=y`                                                |
| CVE-2023-3611 (lts, mitigation)          |                                                    | Out of bounds access  |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-31436 (mitigation)              |                                                    | Out of bounds access  |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| [[CVE-2023-4206 (lts, cos)]]             | [[Exploit Table#UAF on Qdisc into eBPF shellcode]] | UAF                   | When calling `route4_change` on a routing filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                            | Use CVE-2023-0597 to put payload at fixed kernel address                                  | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_ROUTE4=y` `CONFIG_BPF_SYSCALL=y` |
| [[CVE-2023-4207 (lts, cos)]]             | [[Exploit Table#UAF on Qdisc into eBPF shellcode]] | UAF                   | Calling `fw_change` on a fwmark filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                                      | Use CVE-2023-0597 to put payload at fixed kernel address                                  | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_FW=y` `CONFIG_BPF_SYSCALL=y`     |
| [[CVE-2023-4208 (lts, cos, mitigation)]] | [[Exploit Table#UAF on Qdisc into eBPF shellcode]] | UAF                   | Calling `u32_change` on a u32 filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                                        | Use CVE-2023-0597 to put payload at fixed kernel address                                  | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_U32=y` `CONFIG_BPF_SYSCALL=y`    |
| [[CVE-2023-3609 (cos, mitigation)]]      | [[Exploit Table#UAF on Qdisc into eBPF shellcode]] | UAF                   | Sending invalid parameters to u32 classifier can cause premature decrement on `tcf_entry` refcount, leading to UAF on qdisc.                                                                      | Use CVE-2023-0597 to put payload at fixed kernel address                                  | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_U32=y` `CONFIG_BPF_SYSCALL=y`    |
| CVE-2023-3776 (lts, cos, mitigation)     | [[Exploit Table#UAF on Qdisc into eBPF shellcode]] | UAF                   | If `tcf_change_indev` fails, it will decrement reference count incorrectly, leading to UAF on qdisc.                                                                                              | Use CVE-2023-0597 to put payload at fixed kernel address                                  | eBPF shellcode        | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                  |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_FW=y` `CONFIG_BPF_SYSCALL=y`     |
| [[CVE-2023-4623 (lts, cos)]]             |                                                    | UAF                   | When packet enqueued in child class of HFSC qdisc, but later dequed and free child class, a dangling pointer to child is created.                                                                 | Arbitrary write by craying xattr in freed HFSC qdisc                                      | JOP -> ROP            | `commit_creds(prepare_kernel_creds(0))`   | [[Entry Bleed (CVE-2022-4543)]]               | stack pivot to register with correct address                           | `CONFIG_NET_SCHED=y`  `CONFIG_NET_SCH_HFSC=y`                         |
| CVE-2024-41010 (lts)                     |                                                    | UAF                   | TODO: uaf tcx_entry                                                                                                                                                                               |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-5345 (lts, mitigation)          |                                                    | Double Free           | TODO: double free smbfs                                                                                                                                                                           |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2024-26808 (cos)                     |                                                    | UAF                   | TODO: uaf on network device                                                                                                                                                                       |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2024-1086 (lts, mitigation)          |                                                    | Double Free           | TODO: double free on `sk_buff`                                                                                                                                                                    |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-0461 (mitigation)               |                                                    | UAF                   | TODO: uaf with kernel tls stufff                                                                                                                                                                  |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| [[CVE-2023-3777 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]               | UAF                   | `nf_tables_delrule` doesn't check if a chain is bound when `NFTA_RULE_CHAIN` is not given, it simply deletes all rules in the chain. Then if the chain is bound, rules are deleted again.         | spray various nft expressions overlapping with `nft_chain`                                | ROP                   | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                  | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| [[CVE-2023-4015 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]               | UAF                   | TODO                                                                                                                                                                                              | spray various nft expressions overlapping with `nft_chain`                                | ROP                   | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                  | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-4147 (lts, cos, mitigation)     |                                                    | UAF                   | TODO: uaf on nft_chain                                                                                                                                                                            |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| [[CVE-2023-5197 (lts, cos, mitigation)]] | [[Exploit Table#UAF on `nft_chain`]]               | UAF                   | In a transaction, it is possible to use an immediate expression referencing a bound chain to decrease its reference count twice. Evantually this can lead to UAF of nft_chain                     | spray various nft expressions overlapping with `nft_chain`                                | ROP                   | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                  | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2024-0193 (lts, cos, mitigation)     |                                                    |                       |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-52620 (lts, cos, mitigation)    |                                                    |                       |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-32233 (mitigation)              |                                                    |                       |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-3390 (lts, cos, mitigation)     | Unique?                                            | UAF                   | In a transaction, if an anonymous set is freed because it is associated with an invalid rule, it will still remain in the transaction list, and can be referenced by future transaction commands. | `msg_msg` heap pruning, by getting a double freed chunk with 2 `msg_msg`                  | ROP                   | `commit_creds(&init_creds)`               | Leak `pipe_ops` vtable pointer with `msg_msg` | Leak heap pointer by corrupting `msg_msg` header length with `msg_seg` | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-4004 (lts, cos, mitigation)     |                                                    |                       |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| CVE-2023-6111 (lts, cos)                 | Smilar to above                                    |                       |                                                                                                                                                                                                   |                                                                                           |                       |                                           |                                               |                                                                        |                                                                       |
| [[CVE-2023-4244 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]               | Double Free           | In some cases deleting an element from an `nft_set` does not mark it as busy for the GC. If GC is configured to run at a set interval, it will delete element again.                              | Make set element reference an `nft_chain`, so same exploit for UAF on `nft_chain` is used | ROP                   | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                  | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
