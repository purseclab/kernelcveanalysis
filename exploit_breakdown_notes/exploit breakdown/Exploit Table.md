This is a table overview of some properties of each exploit.

# Table Columns
### Exploit Families
Exploit family is noting which exploits are very similar in structure and likely copied the same format and code.

##### UAF on Qdisc into eBPF shellcode
Basically [[CVE-2023-4206 (lts, cos)]], initial bug might be slightly different.

##### UAF on `nft_chain`
Basically [[CVE-2023-3777 (lts)]], initial bug might be changed.

##### Many Free on nftable set element
TODO: detail this more
see CVE-2023-4004 (lts, cos, mitigation) for details

##### Multiple decrement on nft object refcount
This allows reference count of referenced object to be decremented, and a UAF on `nft_object`.
Most are similar in structure to [[CVE-2023-4569 (lts)]].

### Code Execution Method
Code execution method is for example, rop, jop with rop, the eBPF jit shellcode technique, etc

### Privilege Escalation Technique
Privilege Escalation Technique is what the final thing the exploit does to gain privileges is.
This is usually either `commit_creds(init_creds())` (set process to root) or overwrite `/proc/sys/kernel/core_pattern` to control crash dump program.

### KASLR Leak Method
KASLR leak method is like, how it leaked a pointer, or did it use the sidechannel.

| Exploit                                  | Exploit Family?                                                                         | Bug Type              | Bug Details                                                                                                                                                                                                                                                                                                                             | Exploit Techniques                                                                                                                 | Code Execution Method                        | Privilege Escalation Technique            | KASLR Leak Method                                                                                       | Data Address Leaks                                                     | Required Config                                                       |
| ---------------------------------------- | --------------------------------------------------------------------------------------- | --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------- | ----------------------------------------- | ------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | --------------------------------------------------------------------- |
| CVE-2023-4622 (lts, cos)                 | Unique                                                                                  | Race Condition -> UAF | Race condition in `unix_stream_sendpage` with socket GC causes extra refcount decrament on skb.                                                                                                                                                                                                                                         | Cross Cache Attack, Timer fd extend race window, msg_msg                                                                           | ROP                                          | Overwrite `/proc/sys/kernel_core_pattern` | [[Entry Bleed (CVE-2022-4543)]]                                                                         | leak heap address with corrupted `msg_msg`                             | `CONFIG_UNIX=y`                                                       |
| [[CVE-2024-36972 (lts, cos)]]            | Unique                                                                                  | Race Condition -> UAF | Race condition in unix sockets involving socket GC and out of band messages                                                                                                                                                                                                                                                             | Cross Cache Attack, Timer fd extend race window                                                                                    | overwrite function pointer -> eBPF shellcode | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_AF_UNIX_OOB=y` `CONFIG_BPF_SYSCALL=y`                         |
| CVE-2024-39503 (lts, cos)                | Unique                                                                                  | Race Condition -> UAF |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    | None, Arbitrary Write                        | Overwrite `/proc/sys/kernel_core_pattern` | Leak kernel point on heap                                                                               |                                                                        |                                                                       |
| CVE-2023-52447 (cos)                     |                                                                                         | Race Condition -> UAF |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-6932 (cos)                      |                                                                                         | Race Condition -> UAF |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2024-26925 (lts, cos)                |                                                                                         | Race Condition -> UAF |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| [[CVE-2024-41009 (lts, cos)]]            | Unique                                                                                  | Buffer Overlap        | Malicious `consumer_offset` in eBPF ringbuffer can cause overlapping objects in ringbuffer allowing header to be overwritten                                                                                                                                                                                                            |                                                                                                                                    | ROP                                          | Overwrite `/proc/sys/kernel_core_pattern` | [[Entry Bleed (CVE-2022-4543)]]                                                                         | stack pivot to register with correct address                           | `CONFIG_BPF_SYSCALL=y`                                                |
| CVE-2023-3611 (lts, mitigation)          |                                                                                         | Out of bounds access  |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-31436 (mitigation)              |                                                                                         | Out of bounds access  |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| [[CVE-2023-4206 (lts, cos)]]             | [[Exploit Table#UAF on Qdisc into eBPF shellcode]]                                      | UAF                   | When calling `route4_change` on a routing filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                                                                                                                                                                  | Use CVE-2023-0597 to put payload at fixed kernel address                                                                           | fake vtable -> eBPF shellcode                | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_ROUTE4=y` `CONFIG_BPF_SYSCALL=y` |
| [[CVE-2023-4207 (lts, cos)]]             | [[Exploit Table#UAF on Qdisc into eBPF shellcode]]                                      | UAF                   | Calling `fw_change` on a fwmark filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                                                                                                                                                                            | Use CVE-2023-0597 to put payload at fixed kernel address                                                                           | fake vtable -> eBPF shellcode                | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_FW=y` `CONFIG_BPF_SYSCALL=y`     |
| [[CVE-2023-4208 (lts, cos, mitigation)]] | [[Exploit Table#UAF on Qdisc into eBPF shellcode]]                                      | UAF                   | Calling `u32_change` on a u32 filter bound to a class, some data in filter will be freed, but reference copied to new filter, causing UAF.                                                                                                                                                                                              | Use CVE-2023-0597 to put payload at fixed kernel address                                                                           | fake vtable -> eBPF shellcode                | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_U32=y` `CONFIG_BPF_SYSCALL=y`    |
| [[CVE-2023-3609 (cos, mitigation)]]      | [[Exploit Table#UAF on Qdisc into eBPF shellcode]]                                      | UAF                   | Sending invalid parameters to u32 classifier can cause premature decrement on `tcf_entry` refcount, leading to UAF on qdisc.                                                                                                                                                                                                            | Use CVE-2023-0597 to put payload at fixed kernel address                                                                           | fake vtable -> eBPF shellcode                | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_U32=y` `CONFIG_BPF_SYSCALL=y`    |
| CVE-2023-3776 (lts, cos, mitigation)     | [[Exploit Table#UAF on Qdisc into eBPF shellcode]]                                      | UAF                   | If `tcf_change_indev` fails, it will decrement reference count incorrectly, leading to UAF on qdisc.                                                                                                                                                                                                                                    | Use CVE-2023-0597 to put payload at fixed kernel address                                                                           | fake vtable -> eBPF shellcode                | Overwrite `/proc/sys/kernel_core_pattern` | None, just guess eBPF offset                                                                            |                                                                        | `CONFIG_NET_SCHED=y` `CONFIG_NET_CLS_FW=y` `CONFIG_BPF_SYSCALL=y`     |
| [[CVE-2023-4623 (lts, cos)]]             |                                                                                         | UAF                   | When packet enqueued in child class of HFSC qdisc, but later dequed and free child class, a dangling pointer to child is created.                                                                                                                                                                                                       | Arbitrary write by craying xattr in freed HFSC qdisc                                                                               | JOP -> ROP                                   | `commit_creds(prepare_kernel_creds(0))`   | [[Entry Bleed (CVE-2022-4543)]]                                                                         | stack pivot to register with correct address                           | `CONFIG_NET_SCHED=y`  `CONFIG_NET_SCH_HFSC=y`                         |
| CVE-2024-41010 (lts)                     |                                                                                         | UAF                   | TODO: uaf tcx_entry                                                                                                                                                                                                                                                                                                                     |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-5345 (lts, mitigation)          |                                                                                         | Double Free           | TODO: double free smbfs                                                                                                                                                                                                                                                                                                                 |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2024-26808 (cos)                     |                                                                                         | UAF                   | TODO: uaf on network device                                                                                                                                                                                                                                                                                                             |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2024-1086 (lts, mitigation)          |                                                                                         | Double Free           | TODO: double free on `sk_buff`                                                                                                                                                                                                                                                                                                          |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-0461 (mitigation)               |                                                                                         | UAF                   | TODO: uaf with kernel tls stufff                                                                                                                                                                                                                                                                                                        |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| [[CVE-2023-3777 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]                                                    | UAF                   | `nf_tables_delrule` doesn't check if a chain is bound when `NFTA_RULE_CHAIN` is not given, it simply deletes all rules in the chain. Then if the chain is bound, rules are deleted again.                                                                                                                                               | spray various nft expressions overlapping with `nft_chain`                                                                         | ROP                                          | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                                                                            | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| [[CVE-2023-4015 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]                                                    | UAF                   | TODO                                                                                                                                                                                                                                                                                                                                    | spray various nft expressions overlapping with `nft_chain`                                                                         | ROP                                          | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                                                                            | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-4147 (lts, cos, mitigation)     |                                                                                         | UAF                   | TODO: uaf on nft_chain                                                                                                                                                                                                                                                                                                                  |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| [[CVE-2023-5197 (lts, cos, mitigation)]] | [[Exploit Table#UAF on `nft_chain`]]                                                    | UAF                   | In a transaction, it is possible to use an immediate expression referencing a bound chain to decrease its reference count twice. Evantually this can lead to UAF of nft_chain                                                                                                                                                           | spray various nft expressions overlapping with `nft_chain`                                                                         | ROP                                          | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                                                                            | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2024-0193 (lts, cos, mitigation)     |                                                                                         |                       |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-52620 (lts, cos, mitigation)    |                                                                                         |                       |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-32233 (mitigation)              |                                                                                         |                       |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2023-3390 (lts, cos, mitigation)     | Unique?                                                                                 | UAF                   | In a transaction, if an anonymous set is freed because it is associated with an invalid rule, it will still remain in the transaction list, and can be referenced by future transaction commands.                                                                                                                                       | `msg_msg` heap pruning, by getting a double freed chunk with 2 `msg_msg`                                                           | ROP                                          | `commit_creds(&init_creds)`               | Leak `pipe_ops` vtable pointer with `msg_msg`                                                           | Leak heap pointer by corrupting `msg_msg` header length with `msg_seg` | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-4004 (lts, cos, mitigation)     | [[Exploit Table#Many Free on nftable set element]]                                      | Double Free           | When removing an element from a pipapo set, `nft_pipapo_remove` looks for elements with `NFT_SET_EXT_KEY` and `NFT_SET_EXT_KEY_END`. However an element might not have `NFT_SET_EXT_KEY_END`, and if it doesn't, it is freed, but not removed from the set. This means an elment without `NFT_SET_EXT_KEY_END` can be freed many times. | Uses double free to free `nft_table->udata`, which can be read and controlled.                                                     | ROP                                          | `commit_creds(&init_creds)`               | Leak `nft_object` vtable pointer from udata of nft_table                                                | Leak heap pointer from udata of nft_table                              | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-6111 (lts, cos)                 | [[Exploit Table#Many Free on nftable set element]]                                      | Double Free           | The catchall element in a pipapo set can be freed many times if it is set with a GC timeout, then the GC will free it many times.                                                                                                                                                                                                       | Uses double free to free `nft_table->udata`, which can be read and controlled.                                                     | ROP                                          | `commit_creds(&init_creds)`               | Leak `nft_object` vtable pointer from udata of nft_table                                                | Leak heap pointer from udata of nft_table                              | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| [[CVE-2023-4244 (lts)]]                  | [[Exploit Table#UAF on `nft_chain`]]                                                    | Double Free           | In some cases deleting an element from an `nft_set` does not mark it as busy for the GC. If GC is configured to run at a set interval, it will delete element again.                                                                                                                                                                    | Make set element reference an `nft_chain`, so same exploit for UAF on `nft_chain` is used                                          | ROP                                          | `commit_creds(&init_creds)`               | Leak vtable pointer with UAF                                                                            | Leak heap pointer with UAF                                             | `CONFIG_NETFILTER=y` `CONFIG_NF_TABLES=y`                             |
| [[CVE-2023-4569 (lts)]]                  | [[Exploit Table#Multiple decrement on nft object refcount]]                             | UAF                   | When using a map with a catchall element in nftables, flushing the map (deleting all elements in the map) then deleting the map itself leads to objects referenced by the catchall element having their reference count decramented twice, which can lead to UAF.                                                                       | Uses refcount of freed object overlapping with set element extension data length to create out of bounds reads for extension data. | fake vtable -> ROP                           | `commit_creds(&init_creds)`               | Leak `nft_object` vtable pointer by corrupting another `nft_object` name to point to the vtable pointer | Leak heap address by corrupting set element user data length           | `CONFIG_NETFILTEY=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-6817 (lts, cos, mitigation)     | [[Exploit Table#Multiple decrement on nft object refcount]], mitigation a bit different | UAF                   | `nft_pipapo_walk` uses an incorrect check to see if an element is active. This means it is possible to deactivate the element twice by deleting an element then deleting the set.                                                                                                                                                       | Uses refcount of freed object overlapping with set element extension data length to create out of bounds reads for extension data. | fake vtable -> ROP                           | `commit_creds(&init_creds)`               | Leak `nft_object` vtable pointer by corrupting another `nft_object` name to point to the vtable pointer | Leak heap address by corrupting set element user data length           | `CONFIG_NETFILTEY=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2023-26642 (lts)                     | [[Exploit Table#Multiple decrement on nft object refcount]]                             | UAF                   | `nf_tables_deactivate_set` does not set the dead field, meaning deleting a chain containing an anonymous set with a GC timeout could lead to the set being deleted twice, and set element inside will be deactivated twice.                                                                                                             | Uses refcount of freed object overlapping with set element extension data length to create out of bounds reads for extension data. | fake vtable -> ROP                           | `commit_creds(&init_creds)`               | Leak `nft_object` vtable pointer by corrupting another `nft_object` name to point to the vtable pointer | Leak heap address by corrupting set element user data length           | `CONFIG_NETFILTEY=y` `CONFIG_NF_TABLES=y`                             |
| CVE-2024-27397 (mitigation)              | similar to CVE-2023-6817 (lts, cos, mitigation), only the mitigation exploit            | UAF                   |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2024-1085 (lts, cos)                 |                                                                                         |                       |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
| CVE-2024-26581 (lts, cos, mitigation)    | similar to CVE-2024-1085 (lts, cos), just different bug to get set element double free  |                       |                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                    |                                              |                                           |                                                                                                         |                                                                        |                                                                       |
