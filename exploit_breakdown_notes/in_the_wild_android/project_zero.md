blog post: [project_zero](https://googleprojectzero.blogspot.com/2023/09/analyzing-modern-in-wild-android-exploit.html)

Vulnerable kernel: commits before the June 2023 security patch. Must be using a Mali GPU with one of the following drivers:

Mali GPU Kernel Driver in Midgard GPU Kernel Driver all versions from r6p0 - r32p0, Bifrost GPU Kernel Driver all versions from r0p0 - r42p0, Valhall GPU Kernel Driver all versions from r19p0 - r42p0, and Avalon GPU Kernel Driver all versions from r41p0 - r42p0

Overview:

The first two exploits allow an attacker to achieve access from the browser, the following deal with getting root in the android kernel. CVE-2022-22706 allows the attacker to achieve higher userland privileges after escaping the chrome sandbox. This means that the attack now has execution as system_server. Then CVE-2023-0266 and CVE-2023-26083 are used in tandem to achive arbitrary read and write (UAF, CVE-2023-0266) on a snd_ctl_elem_write memory object and write specifically controlled memory into the object with CVE-2023-26083. 

| CVE                                                             | Exploit Method                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Purpose                                                                                                           | POC/Writeup                                                                                                                                                                                            | Writeup                                                                                                                                                                                                                                                                                                                                        | NVD                                                                                                |
| --------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| CVE-2022-4262                                                   | This is a chromium exploit, I will not be writing up for now                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Chrome exploit to achieve RCE                                                                                     | [https://github.com/quangnh89/CVE-2022-4262/tree/main/](https://github.com/quangnh89/CVE-2022-4262/tree/main/)                                                                                         | [https://github.com/quangnh89/CVE-2022-4262/blob/main/FA/FA.md](https://github.com/quangnh89/CVE-2022-4262/blob/main/FA/FA.md)                                                                                                                                                                                                                 | [https://nvd.nist.gov/vuln/detail/CVE-2022-4262](https://nvd.nist.gov/vuln/detail/CVE-2022-4262)   |
| CVE-2022-3038                                                   | This is a chromium exploit, I will not be writing up for now                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Chrome exploit to escape sandbox                                                                                  |                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                | [https://nvd.nist.gov/vuln/detail/CVE-2022-3038](https://nvd.nist.gov/vuln/detail/CVE-2022-3038)   |
| CVE-2022-22706                                                  | Allocate a new read-write memory page and import the mapping iwht KBASE_REG_CPU_WR (which is inadvertently granted GPU write access). Map the buffer into GPU VA space. Unmap this space, then remap the same address manualy with a read only page. The GPU will still see this memory as writeable and you recieve arbitrary write.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Mali gpu kernel driver exploit allowing for write access in read only memory for non-privileged users             | [https://starlabs.sg/blog/2025/12-mali-cious-intent-exploiting-gpu-vulnerabilities-cve-2022-22706/](https://starlabs.sg/blog/2025/12-mali-cious-intent-exploiting-gpu-vulnerabilities-cve-2022-22706/) |                                                                                                                                                                                                                                                                                                                                                | [https://nvd.nist.gov/vuln/detail/CVE-2022-22706](https://nvd.nist.gov/vuln/detail/CVE-2022-22706) |
| [CVE-2023-0266](https://nvd.nist.gov/vuln/detail/CVE-2023-0266) | Race condition in the 32-bit compatibility layer of the ALSA driver. Race the snd_ctl_elem_add and snd_ctl_elem_write_user_compat calls so that write is executed with freed memory then you have a use after free. To recover this written segment, an new heap spray was created using the gpu driver. They used REQ_SOFT_JIT_FREE jobs to recover memory so they could use kmalloc_array/copy_to_user to have better control over spray                                                                                                                                                                                                                                                                                                                                                            | race condition in sound subsystem userspace giving arbitrary read and write in kerneland                          | [https://www.cve.news/cve-2023-0266/](https://www.cve.news/cve-2023-0266/)                                                                                                                             | [https://github.com/SeanHeelan/claude_opus_cve_2023_0266/tree/main](https://github.com/SeanHeelan/claude_opus_cve_2023_0266/tree/main)                                                                                                                                                                                                         | [https://nvd.nist.gov/vuln/detail/CVE-2023-0266](https://nvd.nist.gov/vuln/detail/CVE-2023-0266)   |
| CVE-2023-26083                                                  | This seems to really be two vulns: CVE-2023-26083 and CVE-2023-48409. The POC contains explanations of both of them. The goal is to overwrite a pipe_buffer of controlled size. To do this, spray with kbase_kcpu_command_queue objects followed by pipe_buffer arrays. We will create two distinct target pipe_buffers, one for read operations and the other for write, as they cannot be used twice. To deal with the pipe_buffer->page pointer, write a second pipe_buffer object in place of one of the leaked then freed kbase_kcpu_command_queues, then you will be able to repeatedly use a pipe_buffere object with a legitimate page pointer. then find all the pages in VMEMMAP_START to leak KASLR then walk the task->tasks list to get current task in kernel and zero the cred struct. | Mali gpu driver exploit giving 16 bytes of write in a known address. This vuln also has the ability to leak KASLR | [https://github.com/0x36/Pixel_GPU_Exploit/blob/main/poc.cpp](https://github.com/0x36/Pixel_GPU_Exploit/blob/main/poc.cpp)                                                                             | [https://8ksec.io/cve-2023-26083-kernel-pointer-leakage-in-mali-gpus-timeline-stream-message-buffers/?srsltid=AfmBOorLQ8Nm3lRUnv9A1qBbekf9zWdJJPwiQP1DHLu7FGRDaLT7Trgm](https://8ksec.io/cve-2023-26083-kernel-pointer-leakage-in-mali-gpus-timeline-stream-message-buffers/?srsltid=AfmBOorLQ8Nm3lRUnv9A1qBbekf9zWdJJPwiQP1DHLu7FGRDaLT7Trgm) | [https://nvd.nist.gov/vuln/detail/cve-2023-26083](https://nvd.nist.gov/vuln/detail/cve-2023-26083) |