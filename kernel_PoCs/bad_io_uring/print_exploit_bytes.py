with open('bad_io_uring.so', 'rb') as f:
    data = f.read()

PART_LEN = 4096
calls = ''
for i in range(0, len(data), PART_LEN):
    calls += f'    out = concatArrays(out, exploitPart{i}());\n'

    part = data[i:i+PART_LEN]
    print(f'''
static byte[] exploitPart{i}() {{
    return new byte[] {{{','.join(f'(byte){n}' for n in part)}}};
}}
''')

print(f'''
static byte[] concatArrays(byte[] a, byte[] b) {{
    byte[] result = new byte[a.length + b.length];
    System.arraycopy(a, 0, result, 0, a.length);
    System.arraycopy(b, 0, result, a.length, b.length);
    return result;
}}

static byte[] exploit_bytes() {{
    byte[] out = new byte[0];
{calls}
    return out;
}}
''')
