// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#ifndef __NR_ioctl
#define __NR_ioctl 29
#endif
#ifndef __NR_mmap
#define __NR_mmap 222
#endif
#ifndef __NR_openat
#define __NR_openat 56
#endif
#ifndef __NR_sendmsg
#define __NR_sendmsg 211
#endif
#ifndef __NR_socket
#define __NR_socket 198
#endif

#define BITMASK(bf_off,bf_len) (((1ull << (bf_len)) - 1) << (bf_off))
#define STORE_BY_BITMASK(type,htobe,addr,val,bf_off,bf_len) *(type*)(addr) = htobe((htobe(*(type*)(addr)) & ~BITMASK((bf_off), (bf_len))) | (((type)(val) << (bf_off)) & BITMASK((bf_off), (bf_len))))

uint64_t r[4] = {0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0x0};

int main(void)
{
		syscall(__NR_mmap, /*addr=*/0x1ffff000ul, /*len=*/0x1000ul, /*prot=*/0ul, /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/0x32ul, /*fd=*/(intptr_t)-1, /*offset=*/0ul);
	syscall(__NR_mmap, /*addr=*/0x20000000ul, /*len=*/0x1000000ul, /*prot=PROT_WRITE|PROT_READ|PROT_EXEC*/7ul, /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/0x32ul, /*fd=*/(intptr_t)-1, /*offset=*/0ul);
	syscall(__NR_mmap, /*addr=*/0x21000000ul, /*len=*/0x1000ul, /*prot=*/0ul, /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/0x32ul, /*fd=*/(intptr_t)-1, /*offset=*/0ul);
	const char* reason;
	(void)reason;
				intptr_t res = 0;
	if (write(1, "executing program\n", sizeof("executing program\n") - 1)) {}
memcpy((void*)0x20000240, "/dev/net/tun\000", 13);
	res = syscall(__NR_openat, /*fd=*/0xffffffffffffff9cul, /*file=*/0x20000240ul, /*flags=*/0, /*mode=*/0);
	if (res != -1)
		r[0] = res;
memcpy((void*)0x20000040, "syzkaller0\000\000\000\000\000\000", 16);
*(uint16_t*)0x20000050 = 0x7101;
	syscall(__NR_ioctl, /*fd=*/r[0], /*cmd=*/0x400454ca, /*arg=*/0x20000040ul);
	res = syscall(__NR_socket, /*domain=AF_NETLINK|0x400000000000*/0x400000000010ul, /*type=SOCK_RAW*/3ul, /*proto=*/0);
	if (res != -1)
		r[1] = res;
	res = syscall(__NR_socket, /*domain=*/1ul, /*type=SOCK_STREAM*/1ul, /*proto=*/0);
	if (res != -1)
		r[2] = res;
memcpy((void*)0x20000100, "syzkaller0\000\000\000\000\000\000", 16);
	res = syscall(__NR_ioctl, /*fd=*/r[2], /*cmd=*/0x8933, /*arg=*/0x20000100ul);
	if (res != -1)
r[3] = *(uint32_t*)0x20000110;
*(uint64_t*)0x200012c0 = 0;
*(uint32_t*)0x200012c8 = 0;
*(uint64_t*)0x200012d0 = 0x20000000;
*(uint64_t*)0x20000000 = 0x200005c0;
*(uint32_t*)0x200005c0 = 0x38;
*(uint16_t*)0x200005c4 = 0x24;
*(uint16_t*)0x200005c6 = 0x6541;
*(uint32_t*)0x200005c8 = 0x10;
*(uint32_t*)0x200005cc = -1;
*(uint8_t*)0x200005d0 = 0;
*(uint8_t*)0x200005d1 = 0;
*(uint16_t*)0x200005d2 = 0;
*(uint32_t*)0x200005d4 = r[3];
*(uint16_t*)0x200005d8 = 0;
*(uint16_t*)0x200005da = 1;
*(uint16_t*)0x200005dc = -1;
*(uint16_t*)0x200005de = -1;
*(uint16_t*)0x200005e0 = 0;
*(uint16_t*)0x200005e2 = 0xf;
*(uint16_t*)0x200005e4 = 0xb;
*(uint16_t*)0x200005e6 = 1;
memcpy((void*)0x200005e8, "multiq\000", 7);
*(uint16_t*)0x200005f0 = 8;
*(uint16_t*)0x200005f2 = 2;
*(uint16_t*)0x200005f4 = 0;
*(uint16_t*)0x200005f6 = 0;
*(uint64_t*)0x20000008 = 0x38;
*(uint64_t*)0x200012d8 = 1;
*(uint64_t*)0x200012e0 = 0;
*(uint64_t*)0x200012e8 = 0;
*(uint32_t*)0x200012f0 = 0;
	syscall(__NR_sendmsg, /*fd=*/r[1], /*msg=*/0x200012c0ul, /*f=*/0ul);
*(uint64_t*)0x20000580 = 0;
*(uint32_t*)0x20000588 = 0;
*(uint64_t*)0x20000590 = 0x20000300;
*(uint64_t*)0x20000300 = 0x20000680;
*(uint32_t*)0x20000680 = 0x84;
*(uint16_t*)0x20000684 = 0x2c;
*(uint16_t*)0x20000686 = 0xd27;
*(uint32_t*)0x20000688 = 0x31bd29;
*(uint32_t*)0x2000068c = 0x25dfdbfd;
*(uint8_t*)0x20000690 = 0;
*(uint8_t*)0x20000691 = 0;
*(uint16_t*)0x20000692 = 0;
*(uint32_t*)0x20000694 = r[3];
*(uint16_t*)0x20000698 = 0xc;
*(uint16_t*)0x2000069a = 6;
*(uint16_t*)0x2000069c = 0;
*(uint16_t*)0x2000069e = 0;
*(uint16_t*)0x200006a0 = 7;
*(uint16_t*)0x200006a2 = 0xfff3;
*(uint16_t*)0x200006a4 = 0xd;
*(uint16_t*)0x200006a6 = 1;
memcpy((void*)0x200006a8, "matchall\000", 9);
*(uint16_t*)0x200006b4 = 0x50;
*(uint16_t*)0x200006b6 = 2;
*(uint16_t*)0x200006b8 = 0x4c;
*(uint16_t*)0x200006ba = 2;
*(uint16_t*)0x200006bc = 0x48;
STORE_BY_BITMASK(uint16_t, , 0x200006be, 1, 0, 14);
STORE_BY_BITMASK(uint16_t, , 0x200006bf, 0, 6, 1);
STORE_BY_BITMASK(uint16_t, , 0x200006bf, 0, 7, 1);
*(uint16_t*)0x200006c0 = 9;
*(uint16_t*)0x200006c2 = 1;
memcpy((void*)0x200006c4, "gact\000", 5);
*(uint16_t*)0x200006cc = 0x1c;
STORE_BY_BITMASK(uint16_t, , 0x200006ce, 2, 0, 14);
STORE_BY_BITMASK(uint16_t, , 0x200006cf, 0, 6, 1);
STORE_BY_BITMASK(uint16_t, , 0x200006cf, 1, 7, 1);
*(uint16_t*)0x200006d0 = 0x18;
*(uint16_t*)0x200006d2 = 2;
*(uint32_t*)0x200006d4 = 0x655c;
*(uint32_t*)0x200006d8 = 2;
*(uint32_t*)0x200006dc = 0x1ffffffe;
*(uint32_t*)0x200006e0 = 9;
*(uint32_t*)0x200006e4 = 0x800;
*(uint16_t*)0x200006e8 = 4;
*(uint16_t*)0x200006ea = 6;
*(uint16_t*)0x200006ec = 0xc;
*(uint16_t*)0x200006ee = 7;
*(uint32_t*)0x200006f0 = 0;
*(uint32_t*)0x200006f4 = 0;
*(uint16_t*)0x200006f8 = 0xc;
*(uint16_t*)0x200006fa = 8;
*(uint32_t*)0x200006fc = 2;
*(uint32_t*)0x20000700 = 3;
*(uint64_t*)0x20000308 = 0x84;
*(uint64_t*)0x20000598 = 1;
*(uint64_t*)0x200005a0 = 0;
*(uint64_t*)0x200005a8 = 0;
*(uint32_t*)0x200005b0 = 0x10;
	syscall(__NR_sendmsg, /*fd=*/r[1], /*msg=*/0x20000580ul, /*f=*/0ul);
	return 0;
}
