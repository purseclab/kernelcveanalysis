/**
 * @name Struct locations
 * @description Retrieves the name, file, and exact coordinates of all struct definitions.
 * @kind table
 */

import cpp

from Struct s, Field f, int index, int isAnon
where
    // getAField doesn't support index so use getAMember
    s.getAField() = f
    and s.getAMember(index) = f
    and if s.isAnonymous()
        then isAnon = 1
        else isAnon = 0
select
    s.getName(),
    isAnon,
    f.getName(),
    // f.getInitializationOrder(),
    index,
    s.getLocation()