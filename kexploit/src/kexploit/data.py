from pathlib import Path
import os

def kexploit_base_dir() -> Path:
    path = Path(os.path.abspath(os.environ['KEXPLOIT_DATA_DIR']))
    path.mkdir(parents=True, exist_ok=True)
    return path

# returns a folder used to store files of a certain type
def kexploit_data_dir(name: str) -> Path:
    path = Path(os.path.join(kexploit_base_dir(), name))
    path.mkdir(parents=True, exist_ok=True)
    return path

# folder for storing ghidra projects for kernel analysis
def ghidra_project_dir() -> Path:
    return kexploit_data_dir('kernel_ghidra_projects')

# stores kernel elfs for analyzed kernels
def kernel_image_dir() -> Path:
    return kexploit_data_dir('kernels')

# Stores metadata and artifacts about syzkaller bugs
def syzkaller_db_dir() -> Path:
    return kexploit_data_dir('syzkaller_bugs')