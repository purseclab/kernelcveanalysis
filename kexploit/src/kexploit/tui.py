from dataclasses import dataclass
from enum import StrEnum

from rich.console import Console

from .parse import Span, LexedCode

@dataclass
class SrcCodeError:
    message: str
    span: Span
    code: LexedCode

class KexploitConsole:
    def __init__(self):
        self.console = Console(highlight=False)
    
    def print_diff(self, diff: str):
        self.console.print('=' * 30 + ' DIFF ' + '=' * 30)

        for line in diff.splitlines():
            if line.startswith('-'):
                color = 'red'
            elif line.startswith('+'):
                color = 'green'
            elif line.startswith('@@'):
                color = 'blue'
            else:
                color = ''

            self.console.print(line, style=color)
    
    def src_code_error(self, code_error: SrcCodeError):
        self.console.print('[red bold]Eror')

console = KexploitConsole()