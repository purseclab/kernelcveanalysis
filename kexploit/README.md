# Kexploit

Tool for automatic exploit adaptation between linux kernels.

## Setup

Install [uv](https://docs.astral.sh/uv/getting-started/installation/) python package / project manager to run.

Other tools are needed for certain functionality:
- [vmlinux-to-elf](https://github.com/marin-m/vmlinux-to-elf) for loading kernel images for exploit adaptation
- [android-ndk](https://github.com/purseclab/kernelcveanalysis/blob/main/exploit_breakdown_notes/Installing%20Android%20NDK.md) for compiling syzkall POCs to test on cuttlefish
  - You will also need to update `./compile.sh` file to point to android-ndk installation folder
- `syz-prog2c` binary from [syzkaller](https://github.com/google/syzkaller) to translate syz DSL pocs to C pocs for running on cuttlefish
  - place `syz-prog2c` binary in same current working directory you run kexploit in
- [ghidra](https://github.com/NationalSecurityAgency/ghidra) for analyzing kernels and adapting exploits between kernels
  - Point `GHIDRA_INSTALL_DIR` env variable to folder containing ghidra release downloaded from github (can be done in .env file)

### .env file

Certain environmant variables are needed fro certain functionallity, and they can be put in a .env file.

Example .env:

```
# OpenAI api key for automatic exploit annotation
OPENAI_API_KEY="REDACTED"
# Folder to store all kexploit data (syzkall artifacts, kernel binaries, ghidra data, etc) in
KEXPLOIT_DATA_DIR="/home/jack/Documents/college/purdue/research/kernelcveanalysis/kexploit/kexploit_data/"
# Folder containing ghidra release for exploit adaptation
GHIDRA_INSTALL_DIR="/home/jack/Documents/college/purdue/research/kernelcveanalysis/kexploit/ghidra_11.3.2_PUBLIC/"
```

## Running

In the kexploit folder, run `uv run kexploit` to run kexploit. There are various commands and subcommands that can be run (see `uv run kexploit --help` or `src/kexploit/main.py` for details).
